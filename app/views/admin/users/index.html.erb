<%= turbo_frame_tag "admin_users_content" do %>
  <div class="max-w-7xl mx-auto px-4 md:px-0">
    <div class="bg-white rounded-lg shadow-lg p-4 md:p-6 mb-6">
      <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-6">üõ°Ô∏è Panel de Administraci√≥n - Gesti√≥n de Usuarios</h2>

      <div class="mb-6">
        <%= link_to "‚ûï Crear nuevo usuario", new_admin_user_path, class: "btn btn-success", "aria-label": "Crear un nuevo usuario aspirante" %>
      </div>

    <% if @users.any? %>
      <div class="overflow-x-auto -mx-4 md:mx-0">
        <table class="min-w-full bg-white border border-gray-300 rounded-lg">
          <thead class="bg-gray-100">
            <tr>
              <th class="px-3 md:px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Email</th>
              <th class="px-3 md:px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider hidden md:table-cell">ID</th>
              <th class="px-3 md:px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Rol</th>
              <th class="px-3 md:px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider hidden lg:table-cell">Creado</th>
              <th class="px-3 md:px-6 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider">Acciones</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-200">
            <% @users.each do |user| %>
              <% cache(user) do %>
                <tr class="hover:bg-gray-50" id="user_<%= user.id %>">
                  <td class="px-3 md:px-6 py-4 text-sm text-gray-900 break-all"><%= user.email %></td>
                  <td class="px-3 md:px-6 py-4 text-sm text-gray-600 hidden md:table-cell"><%= user.id %></td>
                  <td class="px-3 md:px-6 py-4">
                    <span class="inline-block px-3 py-1 rounded-full text-xs font-medium <%= case user.role when 'admin' then 'bg-red-100 text-red-800' when 'reclutador' then 'bg-green-100 text-green-800' else 'bg-blue-100 text-blue-800' end %>">
                      <%= user.role.capitalize %>
                    </span>
                  </td>
                  <td class="px-3 md:px-6 py-4 text-sm text-gray-600 hidden lg:table-cell"><%= user.created_at.strftime("%d/%m/%Y %H:%M") %></td>
                  <td class="px-3 md:px-6 py-4 text-center">
                    <div class="flex justify-center gap-2">
                      <%= link_to edit_admin_user_path(user), title: "Editar usuario", class: "inline-block p-2 hover:bg-yellow-50 rounded", "aria-label": "Editar usuario #{user.email}" do %>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                          <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z" fill="#ffc107"/>
                        </svg>
                      <% end %>
                      <%= link_to admin_user_path(user),
                      data: {
                        controller: "confirm",
                        action: "click->confirm#confirm",
                        confirm_title_value: "Confirmar eliminaci√≥n",
                        confirm_message_value: "¬øEst√° seguro de eliminar al usuario #{user.email}? Esta acci√≥n no se puede deshacer.",
                        confirm_confirm_text_value: "Eliminar usuario"
                      },
                      title: "Eliminar usuario",
                      class: "inline-block p-2 hover:bg-red-50 rounded",
                      "aria-label": "Eliminar usuario #{user.email}" do %>
                      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z" fill="#dc3545"/>
                      </svg>
                    <% end %>
                  </div>
                </td>
              </tr>
              <% end %>
            <% end %>
          </tbody>
        </table>
      </div>
    <% else %>
      <p class="text-center text-gray-500 italic py-8">No hay usuarios en el sistema.</p>
    <% end %>
  </div>
</div>
<% end %>
