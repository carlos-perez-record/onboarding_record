<div class="max-w-4xl mx-auto p-4 sm:p-6 bg-white shadow-lg rounded-lg">
  <div class="mb-4 sm:mb-6">
    <h2 class="text-2xl sm:text-3xl font-bold text-gray-800">
      <%= curriculum.new_record? ? "Registrar Curr√≠culum" : "Editar Curr√≠culum" %>
    </h2>
  </div>

  <% if curriculum.errors.any? %>
    <div role="alert" aria-live="assertive" class="bg-red-50 border-l-4 border-red-500 p-4 mb-6 rounded">
      <h3 class="text-lg font-semibold text-red-800 mb-2">
        <span aria-label="Errores de validaci√≥n">‚ö†Ô∏è</span> Errores encontrados:
      </h3>
      <ul class="list-disc list-inside space-y-1 text-red-700">
          <% curriculum.errors.full_messages.each do |message| %>
            <li><%= message %></li>
          <% end %>
      </ul>
    </div>
  <% end %>

  <%= form_with(model: curriculum, local: true) do |form| %>
    <fieldset class="mb-6">
      <legend class="text-xl font-semibold text-gray-800 mb-4">Datos Personales</legend>

      <!-- Foto de Perfil -->
      <div class="mb-4" data-controller="photo-upload">
        <%= form.label :photo, "Foto de Perfil (Opcional - JPEG o PNG, m√°ximo 2 MB)", class: "block text-sm font-medium text-gray-700 mb-2" %>
        <div class="relative">
          <%= form.file_field :photo,
              accept: "image/jpeg,image/png",
              class: "hidden",
              data: {
                photo_upload_target: "input",
                action: "change->photo-upload#updateFilename"
              } %>
          <label for="<%= form.field_id(:photo) %>" class="inline-flex items-center px-4 py-2 bg-blue-500 text-white text-sm font-semibold rounded-lg cursor-pointer hover:bg-blue-600 transition-colors duration-200 focus-within:ring-2 focus-within:ring-blue-500 focus-within:ring-offset-2">
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
            </svg>
            Seleccionar foto
          </label>
          <span data-photo-upload-target="filename" class="ml-3 text-sm text-gray-600">Ning√∫n archivo seleccionado</span>
        </div>
        <% if curriculum.persisted? && curriculum.photo.attached? %>
          <div class="mt-3">
            <img src="<%= url_for(curriculum.photo) %>" alt="Foto de perfil actual" class="w-32 h-32 object-cover rounded-lg border-2 border-gray-300" loading="lazy">
            <p class="text-sm text-gray-600 mt-1">Foto actual</p>
          </div>
        <% end %>
      </div>      <!-- Nombre -->
      <div class="mb-4">
        <%= form.label :first_name do %>
          Nombre(s) <span class="text-red-500" aria-label="requerido">*</span>
        <% end %>
        <%= form.text_field :first_name,
            placeholder: "Ej: Juan",
            required: true,
            aria: { required: "true", describedby: "first_name_hint" },
            class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" %>
        <small id="first_name_hint" class="text-sm text-gray-600">M√≠nimo 2 caracteres</small>
      </div>

      <!-- Apellido -->
      <div class="mb-4">
        <%= form.label :last_name do %>
          Apellidos <span class="text-red-500" aria-label="requerido">*</span>
        <% end %>
        <%= form.text_field :last_name,
            placeholder: "Ej: P√©rez Garc√≠a",
            required: true,
            aria: { required: "true", describedby: "last_name_hint" },
            class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" %>
        <small id="last_name_hint" class="text-sm text-gray-600">M√≠nimo 2 caracteres</small>
      </div>

      <!-- Fecha de Nacimiento -->
      <div class="mb-4">
        <%= form.label :birth_date do %>
          Fecha de Nacimiento <span class="text-red-500" aria-label="requerido">*</span>
        <% end %>
        <%= form.date_field :birth_date,
            required: true,
            aria: { required: "true", describedby: "birth_date_hint" },
            class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" %>
        <small id="birth_date_hint" class="text-sm text-gray-600">Debes ser mayor de 18 a√±os</small>
      </div>

      <!-- Tipo de Documento -->
      <div class="mb-4">
        <%= form.label :document_type do %>
          Tipo de Documento <span class="text-red-500" aria-label="requerido">*</span>
        <% end %>
        <%= form.select :document_type,
          [
            ['C√©dula de Ciudadan√≠a (CC)', 'CC'],
            ['C√©dula de Extranjer√≠a (CE)', 'CE'],
            ['Pasaporte (PA)', 'PA'],
            ['Permiso Especial de Permanencia (PEP)', 'PEP'],
            ['Permiso por Protecci√≥n Temporal (PPT)', 'PPT']
          ],
          { prompt: 'Seleccione tipo de documento' },
          {
            required: true,
            aria: { required: "true", describedby: "document_type_hint" },
            class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",
            data: { action: "change->validation#validateDocumentType" }
          }
        %>
        <small id="document_type_hint" class="text-sm text-gray-600">Selecciona el tipo de documento de identidad</small>
      </div>

      <!-- Identificaci√≥n -->
      <div class="mb-4">
        <%= form.label :identification do %>
          N√∫mero de Identificaci√≥n <span class="text-red-500" aria-label="requerido">*</span>
        <% end %>
        <%= form.text_field :identification,
            placeholder: "Ej: 1234567890",
            required: true,
            aria: { required: "true", describedby: "identification_hint" },
            class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",
            data: { validation_target: "identificationField" } %>
        <small id="identification_hint" class="text-sm text-gray-600">√önico en el sistema</small>
      </div>

      <!-- Tel√©fono -->
      <div class="mb-4" data-controller="validation">
        <%= form.label :phone_number do %>
          Tel√©fono <span class="text-red-500" aria-label="requerido">*</span>
        <% end %>
        <div class="flex gap-2">
          <%= form.select :phone_country_code,
            [
              ['üá®üá¥ +57 (Colombia)', '+57'],
              ['üá∫üá∏ +1 (USA)', '+1'],
              ['üá≤üáΩ +52 (M√©xico)', '+52'],
              ['üá¶üá∑ +54 (Argentina)', '+54'],
              ['üáßüá∑ +55 (Brasil)', '+55'],
              ['üá®üá± +56 (Chile)', '+56'],
              ['üáµüá™ +51 (Per√∫)', '+51'],
              ['üá™üá® +593 (Ecuador)', '+593'],
              ['üáªüá™ +58 (Venezuela)', '+58'],
              ['üá™üá∏ +34 (Espa√±a)', '+34']
            ],
            { selected: curriculum.phone_country_code || '+57' },
            {
              class: "w-32 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
            }
          %>
          <%= form.text_field :phone_number,
              placeholder: "300 1234567",
              required: true,
              pattern: "[0-9\\s]{7,15}",
              aria: { required: "true", describedby: "phone_number_hint" },
              class: "flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" %>
        </div>
        <small id="phone_number_hint" class="text-sm text-gray-600">Solo n√∫meros (7-15 d√≠gitos)</small>
      </div>

      <!-- Direcci√≥n -->
      <div class="mb-4">
        <%= form.label :address, "Direcci√≥n de Residencia", class: "block text-sm font-medium text-gray-700 mb-2" %>
        <%= form.text_field :address,
            placeholder: "Ej: Carrera 5 #10-20",
            aria: { describedby: "address_hint" },
            class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" %>
        <small id="address_hint" class="text-sm text-gray-600">Direcci√≥n completa de residencia</small>
      </div>

      <!-- Ubicaci√≥n con Stimulus -->
      <div data-controller="location"
           data-location-initial-department-value="<%= curriculum.department %>"
           data-location-initial-city-value="<%= curriculum.city %>">

        <!-- Pa√≠s -->
        <div class="mb-4">
          <%= form.label :country, "Pa√≠s", class: "block text-sm font-medium text-gray-700 mb-2" %>
          <%= form.select :country,
            [
              "Afganist√°n", "Albania", "Alemania", "Andorra", "Angola", "Antigua y Barbuda", "Arabia Saudita", "Argelia", "Argentina", "Armenia", "Australia", "Austria", "Azerbaiy√°n",
              "Bahamas", "Banglad√©s", "Barbados", "Bar√©in", "B√©lgica", "Belice", "Ben√≠n", "Bielorrusia", "Birmania", "Bolivia", "Bosnia y Herzegovina", "Botsuana", "Brasil", "Brun√©i", "Bulgaria", "Burkina Faso", "Burundi", "But√°n",
              "Cabo Verde", "Camboya", "Camer√∫n", "Canad√°", "Catar", "Chad", "Chile", "China", "Chipre", "Ciudad del Vaticano", "Colombia", "Comoras", "Corea del Norte", "Corea del Sur", "Costa de Marfil", "Costa Rica", "Croacia", "Cuba",
              "Dinamarca", "Dominica",
              "Ecuador", "Egipto", "El Salvador", "Emiratos √Årabes Unidos", "Eritrea", "Eslovaquia", "Eslovenia", "Espa√±a", "Estados Unidos", "Estonia", "Etiop√≠a",
              "Filipinas", "Finlandia", "Fiyi", "Francia",
              "Gab√≥n", "Gambia", "Georgia", "Ghana", "Granada", "Grecia", "Guatemala", "Guinea", "Guinea Ecuatorial", "Guinea-Bis√°u", "Guyana",
              "Hait√≠", "Honduras", "Hungr√≠a",
              "India", "Indonesia", "Irak", "Ir√°n", "Irlanda", "Islandia", "Islas Marshall", "Islas Salom√≥n", "Israel", "Italia",
              "Jamaica", "Jap√≥n", "Jordania",
              "Kazajist√°n", "Kenia", "Kirguist√°n", "Kiribati", "Kuwait",
              "Laos", "Lesoto", "Letonia", "L√≠bano", "Liberia", "Libia", "Liechtenstein", "Lituania", "Luxemburgo",
              "Madagascar", "Malasia", "Malaui", "Maldivas", "Mal√≠", "Malta", "Marruecos", "Mauricio", "Mauritania", "M√©xico", "Micronesia", "Moldavia", "M√≥naco", "Mongolia", "Montenegro", "Mozambique",
              "Namibia", "Nauru", "Nepal", "Nicaragua", "N√≠ger", "Nigeria", "Noruega", "Nueva Zelanda",
              "Om√°n",
              "Pa√≠ses Bajos", "Pakist√°n", "Palaos", "Panam√°", "Pap√∫a Nueva Guinea", "Paraguay", "Per√∫", "Polonia", "Portugal",
              "Reino Unido", "Rep√∫blica Centroafricana", "Rep√∫blica Checa", "Rep√∫blica del Congo", "Rep√∫blica Democr√°tica del Congo", "Rep√∫blica Dominicana", "Ruanda", "Rumania", "Rusia",
              "Samoa", "San Crist√≥bal y Nieves", "San Marino", "San Vicente y las Granadinas", "Santa Luc√≠a", "Santo Tom√© y Pr√≠ncipe", "Senegal", "Serbia", "Seychelles", "Sierra Leona", "Singapur", "Siria", "Somalia", "Sri Lanka", "Suazilandia", "Sud√°frica", "Sud√°n", "Sud√°n del Sur", "Suecia", "Suiza", "Surinam",
              "Tailandia", "Tanzania", "Tayikist√°n", "Timor Oriental", "Togo", "Tonga", "Trinidad y Tobago", "T√∫nez", "Turkmenist√°n", "Turqu√≠a", "Tuvalu",
              "Ucrania", "Uganda", "Uruguay", "Uzbekist√°n",
              "Vanuatu", "Venezuela", "Vietnam",
              "Yemen",
              "Yibuti",
              "Zambia", "Zimbabue"
            ],
            { prompt: "Seleccionar pa√≠s", selected: curriculum.country.present? ? curriculum.country : "Colombia" },
            {
              class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",
              data: { location_target: "country", action: "change->location#countryChanged" },
              aria: { label: "Seleccionar pa√≠s de residencia" }
            }
          %>
        </div>

        <!-- Departamento -->
        <div class="mb-4">
          <%= form.label :department, "Departamento/Regi√≥n", class: "block text-sm font-medium text-gray-700 mb-2" %>
          <div data-location-target="departmentContainer">
            <%= form.text_field :department,
                placeholder: "Ej: Cundinamarca",
                aria: { describedby: "department_hint" },
                class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" %>
          </div>
          <small id="department_hint" class="text-sm text-gray-600">Departamento o regi√≥n donde resides</small>
        </div>

        <!-- Ciudad -->
        <div class="mb-4">
          <%= form.label :city, "Ciudad", class: "block text-sm font-medium text-gray-700 mb-2" %>
          <div data-location-target="cityContainer">
            <%= form.text_field :city,
                placeholder: "Ej: Bogot√°",
                aria: { describedby: "city_hint" },
                class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" %>
          </div>
          <small id="city_hint" class="text-sm text-gray-600">Ciudad donde resides actualmente</small>
        </div>
      </div>

      <!-- Cargo o T√≠tulo Breve -->
      <div class="mb-4">
        <%= form.label :job_title, "Cargo o T√≠tulo Breve de su Hoja de Vida", class: "block text-sm font-medium text-gray-700 mb-2" %>
        <%= form.text_field :job_title,
            placeholder: "Ej: Ingeniero de Software Senior, Dise√±ador Gr√°fico, Contador P√∫blico",
            aria: { describedby: "job_title_hint" },
            class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" %>
        <small id="job_title_hint" class="text-sm text-gray-600">T√≠tulo profesional o cargo que mejor te describe (m√°ximo 100 caracteres)</small>
      </div>

      <!-- Perfil/Descripci√≥n Personal -->
      <div class="mb-4">
        <%= form.label :profile_description, "Perfil o Descripci√≥n Personal", class: "block text-sm font-medium text-gray-700 mb-2" %>
        <%= form.text_area :profile_description,
            placeholder: "Describe tu perfil profesional...",
            rows: 5,
            aria: { describedby: "profile_description_hint" },
            class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" %>
        <small id="profile_description_hint" class="text-sm text-gray-600">M√°ximo 2000 caracteres</small>
      </div>

      <!-- Disponibilidad para Viajar -->
      <div class="mb-4" role="group" aria-labelledby="travel_label">
        <p id="travel_label" class="block text-sm font-medium text-gray-700 mb-2">¬øDisponibilidad para Viajar?</p>
        <div class="flex items-center space-x-4">
          <label class="inline-flex items-center">
            <%= form.radio_button :available_to_travel, true,
                aria: { label: "S√≠, disponible para viajar" },
                class: "mr-2" %>
            <span>S√≠</span>
          </label>
          <label class="inline-flex items-center">
            <%= form.radio_button :available_to_travel, false,
                aria: { label: "No disponible para viajar" },
                class: "mr-2" %>
            <span>No</span>
          </label>
        </div>
      </div>

      <!-- Disponibilidad para Cambio de Residencia -->
      <div class="mb-4" role="group" aria-labelledby="relocate_label">
        <p id="relocate_label" class="block text-sm font-medium text-gray-700 mb-2">¬øDisponibilidad para Cambio de Residencia?</p>
        <div class="flex items-center space-x-4">
          <label class="inline-flex items-center">
            <%= form.radio_button :available_to_relocate, true,
                aria: { label: "S√≠, disponible para cambio de residencia" },
                class: "mr-2" %>
            <span>S√≠</span>
          </label>
          <label class="inline-flex items-center">
            <%= form.radio_button :available_to_relocate, false,
                aria: { label: "No disponible para cambio de residencia" },
                class: "mr-2" %>
            <span>No</span>
          </label>
        </div>
      </div>

      <!-- Idiomas con Stimulus -->
      <div class="mb-4" data-controller="languages">
        <%= form.label :languages, "Idiomas", class: "block text-sm font-medium text-gray-700 mb-2" %>
        <div class="space-y-3">
          <div class="flex items-center">
            <label class="inline-flex items-center">
              <input type="checkbox" name="curriculum[languages][]" value="Espa√±ol" <% if (curriculum.languages || []).include?('Espa√±ol') %>checked<% end %> class="mr-2 rounded">
              <span>Espa√±ol</span>
            </label>
          </div>
          <div class="flex items-center">
            <label class="inline-flex items-center">
              <input type="checkbox" name="curriculum[languages][]" value="Ingl√©s" <% if (curriculum.languages || []).include?('Ingl√©s') %>checked<% end %> class="mr-2 rounded">
              <span>Ingl√©s</span>
            </label>
          </div>
          <div class="mt-4">
            <p class="text-sm font-medium text-gray-700 mb-2">Otros idiomas <span class="text-gray-500">(opcional)</span>:</p>
            <div data-languages-target="container"
                 role="list"
                 aria-live="polite"
                 aria-label="Idiomas adicionales agregados"
                 class="space-y-2">
              <% (curriculum.languages || []).reject { |lang| ['Espa√±ol', 'Ingl√©s'].include?(lang) }.each do |lang| %>
                <div class="flex items-center mb-2 transition-opacity duration-300" role="listitem">
                  <input type="hidden" name="curriculum[languages][]" value="<%= lang %>">
                  <span class="mr-3 text-gray-700"><%= lang %></span>
                  <button type="button"
                          data-action="click->languages#removeLanguage"
                          aria-label="Eliminar idioma <%= lang %>"
                          class="btn btn-danger py-1 px-3 text-sm">
                    Eliminar
                  </button>
                </div>
              <% end %>
            </div>
            <div class="flex gap-2 mt-3">
              <input type="text"
                     data-languages-target="input"
                     placeholder="Ej: Portugu√©s, Franc√©s, etc."
                     aria-label="Agregar idioma adicional"
                     class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
              <button type="button"
                      data-action="click->languages#addLanguage"
                      aria-label="Agregar idioma a la lista"
                      class="btn btn-primary py-2 px-4">
                Agregar Idioma
              </button>
            </div>
          </div>
          <input type="hidden" name="curriculum[languages][]" value="">
        </div>
      </div>

      <!-- Informaci√≥n Acad√©mica con Stimulus -->
      <div class="mt-8" data-controller="studies">
        <h3 class="text-xl font-semibold text-gray-800 mb-4">Informaci√≥n Acad√©mica</h3>

        <!-- Nivel de Estudios (fuera del panel) -->
        <div class="flex items-end gap-3 mb-4">
          <div class="flex-1">
            <%= form.label :education_level do %>
              Nivel de Estudios <span class="text-red-500" aria-label="requerido">*</span>
            <% end %>
            <%= form.select :education_level,
              [
                ['Ninguno', 'ninguno'],
                ['Primaria', 'primaria'],
                ['Secundaria', 'secundaria'],
                ['T√©cnico', 'tecnico'],
                ['Tecn√≥logo', 'tecnologico'],
                ['Profesional', 'profesional'],
                ['Posgrado', 'posgrado']
              ],
              { prompt: 'Escoja el nivel de estudios' },
              {
                required: true,
                aria: { required: "true", describedby: "education_level_hint" },
                class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",
                data: { studies_target: "educationLevel", action: "change->studies#educationLevelChanged" }
              }
            %>
            <small id="education_level_hint" class="text-sm text-gray-600">Selecciona tu nivel m√°s alto alcanzado</small>
          </div>
          <button type="button"
                  data-studies-target="button"
                  data-action="click->studies#addStudy"
                  aria-label="Agregar nuevo estudio acad√©mico"
                  aria-describedby="studies_hint"
                  class="btn btn-primary py-2 px-4 opacity-50 cursor-not-allowed disabled:opacity-50"
                  title="Pulse para agregar un estudio realizado"
                  disabled>
            + Agregar Estudio
          </button>
        </div>
        <small id="studies_hint" class="text-sm text-gray-600 block mb-3">Agrega los estudios acad√©micos que hayas completado o est√©s cursando</small>

        <div data-studies-target="container"
             role="list"
             aria-live="polite"
             aria-label="Estudios acad√©micos registrados"
             class="space-y-4">
          <%= form.fields_for :studies do |study_form| %>
            <div class="border border-gray-300 rounded-lg p-4 bg-gray-50">
              <div class="flex justify-between items-center mb-4">
                <h4 class="text-lg font-semibold text-gray-800">Estudio</h4>
                <%= study_form.check_box :_destroy, style: "display: none;" %>
                <button type="button"
                        data-action="click->studies#removeStudy"
                        class="btn btn-danger py-1 px-3 text-sm">
                  Eliminar
                </button>
              </div>

              <div class="mb-3">
                <%= study_form.label :institution, "Instituci√≥n *", class: "block text-sm font-medium text-gray-700 mb-2" %>
                <%= study_form.text_field :institution, class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" %>
              </div>

              <div class="mb-3">
                <%= study_form.label :status, "Estado", class: "block text-sm font-medium text-gray-700 mb-2" %>
                <%= study_form.select :status, [['Cursando', 'cursando'], ['Pausado', 'pausado'], ['Finalizado', 'finalizado']], { include_blank: 'Seleccionar' }, class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" %>
              </div>

              <div class="grid grid-cols-2 gap-4 mb-3">
                <div>
                  <%= study_form.label :start_date, "Fecha Inicio", class: "block text-sm font-medium text-gray-700 mb-2" %>
                  <%= study_form.date_field :start_date, class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" %>
                </div>
                <div>
                  <%= study_form.label :end_date, "Fecha Fin", class: "block text-sm font-medium text-gray-700 mb-2" %>
                  <%= study_form.date_field :end_date, class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" %>
                </div>
              </div>

              <div>
                <%= study_form.label :title, "T√≠tulo", class: "block text-sm font-medium text-gray-700 mb-2" %>
                <%= study_form.text_field :title, class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" %>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    </fieldset>

    <!-- Secci√≥n: Experiencia Laboral -->
    <fieldset class="mb-6" data-controller="work-experiences">
      <legend class="text-xl font-semibold text-gray-800 mb-4">Experiencia Laboral</legend>

      <!-- ¬øTiene experiencia laboral? (selector) -->
      <div class="flex items-end gap-3 mb-4">
        <div class="flex-1">
          <%= form.label :has_work_experience do %>
            ¬øTiene experiencia laboral? <span class="text-red-500" aria-label="requerido">*</span>
          <% end %>
          <%= form.select :has_work_experience,
            [
              ['S√≠', 'true'],
              ['No', 'false']
            ],
            { prompt: 'Escoja una opci√≥n' },
            {
              required: true,
              aria: { required: "true", describedby: "work_experience_hint" },
              class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",
              data: { work_experiences_target: "selector", action: "change->work-experiences#selectorChanged" }
            }
          %>
          <small id="work_experience_hint" class="text-sm text-gray-600">Indica si tienes experiencia laboral previa</small>
        </div>
        <button type="button"
                data-work-experiences-target="button"
                data-action="click->work-experiences#addExperience"
                aria-label="Agregar experiencia laboral"
                aria-describedby="experiences_hint"
                class="btn btn-primary py-2 px-4 opacity-50 cursor-not-allowed disabled:opacity-50"
                title="Pulse para agregar una experiencia laboral"
                disabled>
          + Agregar Experiencia Laboral
        </button>
      </div>
      <small id="experiences_hint" class="text-sm text-gray-600 block mb-3">Agrega las experiencias laborales que hayas tenido</small>

      <div data-work-experiences-target="container"
           role="list"
           aria-live="polite"
           aria-label="Experiencias laborales registradas"
           class="space-y-4">


        <%= form.fields_for :work_experiences do |experience_form| %>
          <div class="work-experience-fields experience-item border border-gray-300 rounded-lg p-4 bg-gray-50" data-new-record="<%= experience_form.object.new_record? %>">
              <%= experience_form.hidden_field :_destroy %>

              <div class="flex justify-between items-center mb-3">
                <h4 class="text-lg font-semibold text-gray-800">Experiencia Laboral</h4>
                <button type="button"
                        data-action="click->work-experiences#removeExperience"
                        aria-label="Eliminar esta experiencia"
                        class="text-red-600 hover:text-red-800 font-bold">
                  ‚ùå Eliminar
                </button>
              </div>

              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="mb-3">
                  <%= experience_form.label :position, "Cargo", class: "block text-sm font-medium text-gray-700 mb-2" %>
                  <%= experience_form.text_field :position,
                      placeholder: "Ej: Desarrollador Full Stack",
                      class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" %>
                </div>

                <div class="mb-3">
                  <%= experience_form.label :company, "Empresa", class: "block text-sm font-medium text-gray-700 mb-2" %>
                  <%= experience_form.text_field :company,
                      placeholder: "Ej: Tech Solutions S.A.S",
                      class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" %>
                </div>
              </div>

              <div class="mb-3">
                <%= experience_form.label :responsibilities, "Funciones y Logros", class: "block text-sm font-medium text-gray-700 mb-2" %>
                <%= experience_form.text_area :responsibilities,
                    placeholder: "Describe tus principales funciones y logros en este cargo...",
                    rows: 4,
                    class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" %>
              </div>

              <div class="mb-3">
                <%= experience_form.label :achievements, "Logros Destacados (Opcional)", class: "block text-sm font-medium text-gray-700 mb-2" %>
                <%= experience_form.text_area :achievements,
                    placeholder: "Logros espec√≠ficos, reconocimientos, proyectos importantes...",
                    rows: 3,
                    class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" %>
              </div>

              <div class="mb-3">
                <%= experience_form.label :status, "Estado", class: "block text-sm font-medium text-gray-700 mb-2" %>
                <%= experience_form.select :status,
                    [['Cursando', 'cursando'], ['Finalizado', 'finalizado']],
                    { include_blank: 'Seleccionar' },
                    class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" %>
              </div>

              <div class="grid grid-cols-2 gap-4">
                <div>
                  <%= experience_form.label :start_date, "Fecha Inicio", class: "block text-sm font-medium text-gray-700 mb-2" %>
                  <%= experience_form.date_field :start_date, class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" %>
                </div>
                <div>
                  <%= experience_form.label :end_date, "Fecha Fin", class: "block text-sm font-medium text-gray-700 mb-2" %>
                  <%= experience_form.date_field :end_date, class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" %>
                </div>
              </div>
            </div>
          <% end %>
        </div>

      <!-- Template para nuevas experiencias -->
      <template data-work-experiences-target="template">
        <div class="work-experience-fields experience-item border border-gray-300 rounded-lg p-4 bg-gray-50" data-new-record="true">
            <input type="hidden" name="curriculum[work_experiences_attributes][NEW_RECORD][_destroy]" value="0">

            <div class="flex justify-between items-center mb-3">
              <h4 class="text-lg font-semibold text-gray-800">Experiencia Laboral</h4>
              <button type="button"
                      data-action="click->work-experiences#removeExperience"
                      aria-label="Eliminar esta experiencia"
                      class="text-red-600 hover:text-red-800 font-bold">
                ‚ùå Eliminar
              </button>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div class="mb-3">
                <label class="block text-sm font-medium text-gray-700 mb-2">Cargo</label>
                <input type="text" name="curriculum[work_experiences_attributes][NEW_RECORD][position]" placeholder="Ej: Desarrollador Full Stack" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
              </div>

              <div class="mb-3">
                <label class="block text-sm font-medium text-gray-700 mb-2">Empresa</label>
                <input type="text" name="curriculum[work_experiences_attributes][NEW_RECORD][company]" placeholder="Ej: Tech Solutions S.A.S" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
              </div>
            </div>

            <div class="mb-3">
              <label class="block text-sm font-medium text-gray-700 mb-2">Funciones y Logros</label>
              <textarea name="curriculum[work_experiences_attributes][NEW_RECORD][responsibilities]" placeholder="Describe tus principales funciones y logros..." rows="4" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
            </div>

            <div class="mb-3">
              <label class="block text-sm font-medium text-gray-700 mb-2">Logros Destacados (Opcional)</label>
              <textarea name="curriculum[work_experiences_attributes][NEW_RECORD][achievements]" placeholder="Logros espec√≠ficos..." rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
            </div>

            <div class="mb-3">
              <label class="block text-sm font-medium text-gray-700 mb-2">Estado</label>
              <select name="curriculum[work_experiences_attributes][NEW_RECORD][status]" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                <option value="">Seleccionar</option>
                <option value="cursando">Cursando</option>
                <option value="finalizado">Finalizado</option>
              </select>
            </div>

            <div class="grid grid-cols-2 gap-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Fecha Inicio</label>
                <input type="date" name="curriculum[work_experiences_attributes][NEW_RECORD][start_date]" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Fecha Fin</label>
                <input type="date" name="curriculum[work_experiences_attributes][NEW_RECORD][end_date]" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
              </div>
            </div>
        </div>
      </template>
    </fieldset>

    <!-- Botones de acci√≥n -->
    <div class="flex gap-4 mt-8">
      <% submit_text = curriculum.new_record? ? "Registrar Curr√≠culum" : "Actualizar Curr√≠culum" %>
      <button type="submit" class="btn btn-success py-2 px-4 flex-1"><%= submit_text %></button>
      <% cancel_path = current_user.reclutador? ? recruiter_aspirants_path : root_path %>
      <%= link_to "Cancelar", cancel_path, class: "btn btn-secondary py-2 px-4 flex-1" %>
    </div>
  <% end %>
</div>

